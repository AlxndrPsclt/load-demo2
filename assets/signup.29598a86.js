import{u as j,a as q,b as z,_ as Y}from"./useRelays.298ef0a9.js";import{d as H,k as J,l as o,aa as V,b4 as Q,u as W,o as v,c as N,b as r,q as k,t as b,e as c,a as K,b9 as B,bd as F,ac as x,i as X,ab as $,_ as Z}from"./index.513abb1d.js";import{b as E}from"./route-block.011d1056.js";import"./InputField.vue_vue_type_script_setup_true_lang.5f7db2a0.js";const ee={flex:"","flex-col":"","h-full":"","justify-center":""},oe={"text-4xl":"","m-3":""},le={"opacity-75":""},se=X(" \xB7 "),ae={key:0},ne=["disabled"],te={key:1},ue=["disabled"],P=H({__name:"signup",setup(ie){const m=j();window.wgun=m,J();const t=o(),a=o("INITIAL"),O=o(),h=o("INITIAL"),d=o(""),u=o("INITIAL"),g=o(!1),i=o(!1),p=o(!1),w=o(!1),l=o(!1),C=o(null),y=o(null);function T(){g.value=g.value||a.value=="OK",i.value=i.value||a.value=="OK"&&u.value=="OK"&&!l.value,w.value=a.value=="OK"&&l.value,p.value=a.value=="OK"&&!l.value,l.value&&a.value=="OK"&&u.value=="OK"&&y.value.focus()}function A(){i.value=i.value||a.value=="OK"&&u.value=="OK"&&!l.value,l.value&&a.value=="OK"&&u.value=="OK"&&y.value.focus()}function U(){S.value&&C.value.focus()}const S=V(()=>!l.value&&a.value=="OK"&&h.value=="OK"&&u.value=="OK"),G=V(()=>l.value&&a.value=="OK"&&u.value=="OK");Q(t,async(s,e)=>{a.value!="OK"?(console.log("Email not validated yet"),l.value=!1):(console.log("Does user already exist?"),console.log(`Full sea name! ${f.value}`),m.get(f.value).once(I=>{console.log("Does existingUser exist?"),I?(console.log("Yes, this user exists"),l.value=!0):(console.log("No, this user doesn't exist"),l.value=!1)}))});const f=V(()=>"~@"+t.value);async function D(){if(S)if(console.log("Create an account!!"),console.log(`Signup2 to the Gun network! ${t.value}:${d.value}`),console.log(`Full sea name! ${f.value}`),l.value)console.log("A user with this name already exists; not creating.");else{console.log("No, not yet, will try to create");var s=m.user();s.create(t.value,d.value,function(e){"ok"in e?(console.log("user created"),console.log(s._.sea.epriv),localStorage.setItem("epriv",s._.sea.epriv)):(console.log("There was a problem when creating the user"),console.log(e)),console.log(e)})}else console.log("Not possible to signup!")}async function L(){console.log("SIGNING IN!");var s=m.user();console.log(`Full sea name! ${f.value}`),s.auth(t.value,d.value,e=>{e.err?(console.log(e.err),console.log("Connexion unsucessfull")):(console.log("Connexion succeeded"),console.log(e),window.user=e,console.log(s._.sea.epriv),localStorage.setItem("current_epriv",s._.sea.epriv),localStorage.setItem("current_priv",s._.sea.priv),localStorage.setItem("current_epub",s._.sea.epub),localStorage.setItem("current_pub",s._.sea.pub))})}const{t:_}=W();return(s,e)=>{const I=q,M=z,R=Y;return v(),N("div",ee,[r("div",oe,[r("p",le,[r("span",{class:k(w.value?"text-5xl":"text-2xl")},b(c(_)("signup.signin")),3),se,r("span",{class:k(p.value?"text-5xl":"text-2xl")},b(c(_)("signup.signup")),3)])]),K(I,{ref:"emailFocusRef",modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value=n),"field-domain":"signup",onEmailValidationChanged:e[1]||(e[1]=n=>{a.value=n}),onEmailSubmission:T},null,8,["modelValue"]),K(F,null,{default:B(()=>[g.value?(v(),$(M,{key:0,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=n=>d.value=n),"field-domain":"signup",onPasswordValidationChanged:e[3]||(e[3]=n=>{u.value=n}),onPasswordSubmission:A},null,8,["modelValue"])):x("",!0)]),_:1}),K(F,null,{default:B(()=>[i.value&&p.value?(v(),$(R,{key:0,modelValue:O.value,"onUpdate:modelValue":e[4]||(e[4]=n=>O.value=n),"field-domain":"signup",onNameValidationChanged:e[5]||(e[5]=n=>{h.value=n}),onNameSubmission:U},null,8,["modelValue"])):x("",!0)]),_:1}),i.value&&p.value?(v(),N("div",ae,[r("button",{ref_key:"signupButton",ref:C,btn:"","m-5":"","text-2xl":"",class:"border-rounded-10 bg-#6622aa",disabled:!c(S),onClick:D},b(c(_)("signup.signup-prompt")),9,ne)])):x("",!0),g.value&&w.value?(v(),N("div",te,[r("button",{ref_key:"signinButton",ref:y,btn:"","m-3":"","p-2":"","p-x-4":"","text-lg":"",class:"border-rounded-10 bg-#6622aa",disabled:!c(G),onClick:L},b(c(_)("signup.signin-prompt")),9,ue)])):x("",!0)])}}});typeof E=="function"&&E(P);const me=Z(P,[["__scopeId","data-v-b152c3a2"]]);export{me as default};
